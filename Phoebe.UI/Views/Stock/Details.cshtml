@model Phoebe.Model.Stock

@{
    ViewBag.Title = "库存信息";
    StockInDetail stockIn = ViewBag.StockIn;
    List<StockOutDetail> stockOut = ViewBag.StockOut;
    List<StockMoveDetail> stockMove = ViewBag.StockMove;
    List<TransferDetail> transfer = ViewBag.Transfer;
}

<!-- BEGIN PAGE HEADER-->
<h3 class="page-title">
    @ViewBag.Title
</h3>
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li>
            <i class="fa fa-home"></i>
            <a href="@Url.Action("Index", "Home")">主页</a>
            <i class="fa fa-angle-right"></i>
        </li>
        <li>
            <a href="#">统计报表</a>
            <i class="fa fa-angle-right"></i>
        </li>
        <li>
            <a href="#">@ViewBag.Title</a>
        </li>
    </ul>
</div>
<!-- END PAGE HEADER-->
<!-- BEGIN PAGE CONTENT-->
<div class="row">
    <div class="col-md-12">
        <ul class="nav nav-tabs">
            <li class="active">
                <a href="#tab_info" data-toggle="tab">
                    库存信息
                </a>
            </li>
            <li>
                <a href="#tab_action" data-toggle="tab">
                    操作记录
                </a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade active in" id="tab_info">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th style="width: 20%;">
                                属性
                            </th>
                            <th>
                                说明
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.WarehouseID)
                            </td>
                            <td>
                                @Model.Warehouse.Number
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.CargoID)
                            </td>
                            <td>
                                @Model.Cargo.Name
                            </td>
                        </tr>
                        <tr>
                            <td>
                                所属合同
                            </td>
                            <td>@Model.Cargo.Contract.Name ( @Model.Cargo.Contract.Number )</td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.Count)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.Count)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.InTime)
                            </td>
                            <td>
                                @Model.InTime.ToDateString()
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.OutTime)
                            </td>
                            <td>
                                @Model.OutTime.ToDateString()
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.Source)
                            </td>
                            <td>
                                @if (Model.Source == 0)
                                {
                                    <span>入库</span>
                                }
                                else
                                {
                                    <span>移库</span>
                                }
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.Remark)
                            </td>
                            <td>
                                @Html.DisplayFor(model => model.Remark)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.DisplayNameFor(model => model.Status)
                            </td>
                            <td>
                                @(((EntityStatus)Model.Status).DisplayName())
                            </td>
                        </tr>
                    </tbody>
                </table>

                <hr />
                <p>
                    <a href="@Url.Action("Index", new { controller = "Stock" })" class="btn btn-info"><i class="fa fa-list"></i>&nbsp;回到列表</a>
                </p>
            </div>

            <div class="tab-pane fade" id="tab_action">
                <h3>入库记录</h3>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>
                                入库时间
                            </th>
                            <th>
                                确认时间
                            </th>
                            <th>
                                仓位
                            </th>
                            <th>
                                入库数量
                            </th>
                            <th>
                                操作人
                            </th>
                            <th>
                                状态
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (stockIn != null)
                        {
                        <tr>
                            <td>
                                @stockIn.StockIn.InTime.ToDateString()
                            </td>
                            <td>
                                @stockIn.StockIn.ConfirmTime.ToDateString()
                            </td>
                            <td>
                                @stockIn.Warehouse.Number
                            </td>
                            <td>
                                @stockIn.Count
                            </td>
                            <td>
                                @stockIn.StockIn.User.Name
                            </td>
                            <td>
                                @(((EntityStatus)stockIn.Status).DisplayName())
                            </td>
                        </tr>
                        }
                    </tbody>
                </table>

                <hr />
                <h3>出库记录</h3>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>
                                出库时间
                            </th>
                            <th>
                                确认时间
                            </th>
                            <th>
                                仓位
                            </th>
                            <th>
                                在库数量
                            </th>
                            <th>
                                出库数量
                            </th>
                            <th>
                                操作人
                            </th>
                            <th>
                                状态
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in stockOut)
                        {
                            <tr>
                                <td>
                                    @item.StockOut.OutTime.ToDateString()
                                </td>
                                <td>
                                    @item.StockOut.ConfirmTime.ToDateString()
                                </td>
                                <td>
                                    @item.Warehouse.Number
                                </td>
                                <td>
                                    @item.StoreCount
                                </td>
                                <td>
                                    @item.Count
                                </td>
                                <td>
                                    @item.StockOut.User.Name
                                </td>
                                <td>
                                    @(((EntityStatus)item.Status).DisplayName())
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <hr />
                <h3>移库记录</h3>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>
                                移库时间
                            </th>
                            <th>
                                确认时间
                            </th>
                            <th>
                                源仓位
                            </th>
                            <th>
                                目的仓库
                            </th>
                            <th>
                                移库数量
                            </th>
                            <th>
                                操作人
                            </th>
                            <th>
                                状态
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in stockMove)
                        {
                            <tr>
                                <td>
                                    @item.StockMove.MoveTime.ToDateString()
                                </td>
                                <td>
                                    @item.StockMove.ConfirmTime.ToDateString()
                                </td>
                                <td>
                                    @item.SourceWarehouse.Number
                                </td>
                                <td>
                                    @item.DestinationWarehouse.Number
                                </td>
                                <td>
                                    @item.Count
                                </td>
                                <td>
                                    @item.StockMove.User.Name
                                </td>
                                <td>
                                    @(((EntityStatus)item.Status).DisplayName())
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <hr />
                <h3>转户记录</h3>
                <table class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>
                                转户时间
                            </th>
                            <th>
                                确认时间
                            </th>
                            <th>
                                原合同
                            </th>
                            <th>
                                新合同
                            </th>
                            <th>
                                仓位
                            </th>
                            <th>
                                转户数量
                            </th>
                            <th>
                                操作人
                            </th>
                            <th>
                                状态
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in transfer)
                        {
                            <tr>
                                <td>
                                    @item.Transfer.TransferTime.ToDateString()
                                </td>
                                <td>
                                    @item.Transfer.ConfirmTime.ToDateString()
                                </td>
                                <td>
                                    @item.Transfer.OldCargo.Contract.Name
                                </td>
                                <td>
                                    @item.Transfer.NewCargo.Contract.Name
                                </td>
                                <td>
                                    @item.Warehouse.Number
                                </td>
                                <td>
                                    @item.Count
                                </td>
                                <td>
                                    @item.Transfer.User.Name
                                </td>
                                <td>
                                    @(((EntityStatus)item.Status).DisplayName())
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- END PAGE CONTENT-->

@section Scripts {
    <script type="text/javascript">
        $(function () {
            phoebe.leftNavActive($('#menu-stock-index'));
        });
    </script>
}
